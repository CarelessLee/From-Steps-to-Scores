  0%|                                                                                                                                        | 0/746 [00:00<?, ?it/s]/export/project/jzhanggr/miniconda3/envs/lmflow/lib/python3.9/site-packages/torch/utils/checkpoint.py:464: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/export/project/jzhanggr/miniconda3/envs/lmflow/lib/python3.9/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/export/project/jzhanggr/miniconda3/envs/lmflow/lib/python3.9/site-packages/deepspeed/runtime/zero/stage_1_and_2.py:1830: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  overflow_gpu = get_accelerator().ByteTensor([overflow])
{'loss': 18.4062, 'grad_norm': 4444.610211879875, 'learning_rate': 4.347826086956522e-07, 'epoch': 0.0}
  0%|▏                                                                                                                             | 1/746 [00:24<5:00:13, 24.18s/it]

  0%|▎                                                                                                                             | 2/746 [00:35<3:25:57, 16.61s/it]

  0%|▌                                                                                                                             | 3/746 [00:51<3:19:30, 16.11s/it]
  1%|▋                                                                                                                             | 4/746 [01:01<2:53:53, 14.06s/it]


 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                  | 36/42 [00:04<00:00,  7.25it/s]

{'eval_loss': 5.016813278198242, 'eval_runtime': 7.9727, 'eval_samples_per_second': 41.642, 'eval_steps_per_second': 5.268, 'epoch': 0.01}

  1%|▊                                                                                                                             | 5/746 [01:26<3:39:36, 17.78s/it]

  1%|█                                                                                                                             | 6/746 [01:37<3:10:51, 15.47s/it]

  1%|█▏                                                                                                                            | 7/746 [01:48<2:51:24, 13.92s/it]

  1%|█▎                                                                                                                            | 8/746 [02:04<3:02:01, 14.80s/it]


 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊         | 39/42 [00:05<00:00,  7.36it/s]

{'eval_loss': 44.92018127441406, 'eval_runtime': 8.7717, 'eval_samples_per_second': 37.849, 'eval_steps_per_second': 4.788, 'epoch': 0.02}

  1%|█▌                                                                                                                            | 9/746 [02:25<3:24:55, 16.68s/it]

  1%|█▋                                                                                                                           | 10/746 [02:36<3:03:38, 14.97s/it]

  1%|█▊                                                                                                                           | 11/746 [02:47<2:47:19, 13.66s/it]

  2%|██                                                                                                                           | 12/746 [02:58<2:39:34, 13.04s/it]


 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 41/42 [00:05<00:00,  5.57it/s]

{'eval_loss': 9.973833084106445, 'eval_runtime': 8.2222, 'eval_samples_per_second': 40.378, 'eval_steps_per_second': 5.108, 'epoch': 0.03}

  2%|██▏                                                                                                                          | 13/746 [03:19<3:08:34, 15.44s/it]

  2%|██▎                                                                                                                          | 14/746 [03:31<2:54:28, 14.30s/it]

  2%|██▌                                                                                                                          | 15/746 [03:43<2:43:37, 13.43s/it]

  2%|██▋                                                                                                                          | 16/746 [03:53<2:32:13, 12.51s/it]


 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 41/42 [00:05<00:00,  5.52it/s]

{'eval_loss': 7.808170318603516, 'eval_runtime': 8.1727, 'eval_samples_per_second': 40.623, 'eval_steps_per_second': 5.139, 'epoch': 0.04}

  2%|██▊                                                                                                                          | 17/746 [04:13<2:59:49, 14.80s/it]

  2%|███                                                                                                                          | 18/746 [04:24<2:44:27, 13.55s/it]

  3%|███▏                                                                                                                         | 19/746 [04:34<2:33:19, 12.65s/it]

  3%|███▎                                                                                                                         | 20/746 [04:45<2:26:09, 12.08s/it]


 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 41/42 [00:05<00:00,  5.99it/s]

{'eval_loss': 32.111446380615234, 'eval_runtime': 8.0459, 'eval_samples_per_second': 41.263, 'eval_steps_per_second': 5.22, 'epoch': 0.05}

  3%|███▌                                                                                                                         | 21/746 [05:04<2:52:27, 14.27s/it]

  3%|███▋                                                                                                                         | 22/746 [05:15<2:40:06, 13.27s/it]

  3%|███▊                                                                                                                         | 23/746 [05:26<2:31:33, 12.58s/it]

  3%|████                                                                                                                         | 24/746 [05:37<2:25:24, 12.08s/it]


 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊         | 39/42 [00:05<00:00,  7.38it/s]

{'eval_loss': 0.6513039469718933, 'eval_runtime': 8.5255, 'eval_samples_per_second': 38.942, 'eval_steps_per_second': 4.926, 'epoch': 0.06}

  3%|████▏                                                                                                                        | 25/746 [05:58<2:55:24, 14.60s/it]

  3%|████▎                                                                                                                        | 26/746 [06:09<2:43:07, 13.59s/it]

  4%|████▌                                                                                                                        | 27/746 [06:19<2:31:42, 12.66s/it]
  4%|████▋                                                                                                                        | 28/746 [06:31<2:26:14, 12.22s/it]



 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 41/42 [00:05<00:00,  5.52it/s]

{'eval_loss': 0.5324603915214539, 'eval_runtime': 8.2978, 'eval_samples_per_second': 40.011, 'eval_steps_per_second': 5.062, 'epoch': 0.08}

  4%|████▊                                                                                                                        | 29/746 [06:50<2:52:21, 14.42s/it]

  4%|█████                                                                                                                        | 30/746 [07:00<2:37:03, 13.16s/it]

  4%|█████▏                                                                                                                       | 31/746 [07:11<2:28:21, 12.45s/it]

  4%|█████▎                                                                                                                       | 32/746 [07:21<2:20:22, 11.80s/it]


 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 41/42 [00:05<00:00,  5.85it/s]

{'eval_loss': 6.174887180328369, 'eval_runtime': 8.0553, 'eval_samples_per_second': 41.215, 'eval_steps_per_second': 5.214, 'epoch': 0.09}

  4%|█████▌                                                                                                                       | 33/746 [07:40<2:45:43, 13.95s/it]

  5%|█████▋                                                                                                                       | 34/746 [07:51<2:33:01, 12.89s/it]

  5%|█████▊                                                                                                                       | 35/746 [08:01<2:24:55, 12.23s/it]

  5%|██████                                                                                                                       | 36/746 [08:12<2:19:03, 11.75s/it]


 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊         | 39/42 [00:05<00:00,  7.79it/s]

{'eval_loss': 0.8912603259086609, 'eval_runtime': 8.2096, 'eval_samples_per_second': 40.441, 'eval_steps_per_second': 5.116, 'epoch': 0.1}

  5%|██████▏                                                                                                                      | 37/746 [08:32<2:45:58, 14.05s/it]

  5%|██████▎                                                                                                                      | 38/746 [08:42<2:34:17, 13.08s/it]

  5%|██████▌                                                                                                                      | 39/746 [08:55<2:32:48, 12.97s/it]

  5%|██████▋                                                                                                                      | 40/746 [09:05<2:22:59, 12.15s/it]


 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 41/42 [00:05<00:00,  6.03it/s]

{'eval_loss': 0.6049591302871704, 'eval_runtime': 8.1116, 'eval_samples_per_second': 40.929, 'eval_steps_per_second': 5.178, 'epoch': 0.11}

  5%|██████▊                                                                                                                      | 41/746 [09:25<2:48:22, 14.33s/it]

  6%|███████                                                                                                                      | 42/746 [09:35<2:34:40, 13.18s/it]

  6%|███████▏                                                                                                                     | 43/746 [09:46<2:25:47, 12.44s/it]
  6%|███████▎                                                                                                                     | 44/746 [09:57<2:19:46, 11.95s/it]



 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 41/42 [00:05<00:00,  5.44it/s]

{'eval_loss': 0.7348338961601257, 'eval_runtime': 8.1118, 'eval_samples_per_second': 40.928, 'eval_steps_per_second': 5.178, 'epoch': 0.12}

  6%|███████▌                                                                                                                     | 45/746 [10:16<2:45:04, 14.13s/it]

  6%|███████▋                                                                                                                     | 46/746 [10:27<2:34:06, 13.21s/it]

  6%|███████▉                                                                                                                     | 47/746 [10:38<2:25:18, 12.47s/it]

  6%|████████                                                                                                                     | 48/746 [10:48<2:17:09, 11.79s/it]


 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 41/42 [00:05<00:00,  5.99it/s]

{'eval_loss': 0.7842385172843933, 'eval_runtime': 8.0091, 'eval_samples_per_second': 41.453, 'eval_steps_per_second': 5.244, 'epoch': 0.13}

  7%|████████▏                                                                                                                    | 49/746 [11:07<2:42:52, 14.02s/it]

  7%|████████▍                                                                                                                    | 50/746 [11:18<2:30:48, 13.00s/it]

  7%|████████▌                                                                                                                    | 51/746 [11:28<2:22:03, 12.26s/it]

  7%|████████▋                                                                                                                    | 52/746 [11:39<2:14:52, 11.66s/it]



 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                  | 36/42 [00:04<00:00,  7.14it/s]
{'eval_loss': 0.2052193135023117, 'eval_runtime': 8.2162, 'eval_samples_per_second': 40.408, 'eval_steps_per_second': 5.112, 'epoch': 0.14}

  7%|████████▉                                                                                                                    | 53/746 [11:58<2:41:39, 14.00s/it]

  7%|█████████                                                                                                                    | 54/746 [12:09<2:29:24, 12.95s/it]

  7%|█████████▏                                                                                                                   | 55/746 [12:20<2:22:33, 12.38s/it]
  8%|█████████▍                                                                                                                   | 56/746 [12:31<2:18:55, 12.08s/it]



 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                  | 36/42 [00:04<00:00,  7.26it/s]
{'eval_loss': 0.20980797708034515, 'eval_runtime': 7.889, 'eval_samples_per_second': 42.084, 'eval_steps_per_second': 5.324, 'epoch': 0.15}

  8%|█████████▌                                                                                                                   | 57/746 [12:50<2:42:56, 14.19s/it]

  8%|█████████▋                                                                                                                   | 58/746 [13:01<2:30:18, 13.11s/it]

  8%|█████████▉                                                                                                                   | 59/746 [13:12<2:23:08, 12.50s/it]
  8%|██████████                                                                                                                   | 60/746 [13:23<2:18:31, 12.12s/it]



 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 41/42 [00:05<00:00,  5.76it/s]

{'eval_loss': 0.26422780752182007, 'eval_runtime': 8.317, 'eval_samples_per_second': 39.918, 'eval_steps_per_second': 5.05, 'epoch': 0.16}

  8%|██████████▏                                                                                                                  | 61/746 [13:43<2:46:11, 14.56s/it]

  8%|██████████▍                                                                                                                  | 62/746 [13:56<2:41:19, 14.15s/it]

  8%|██████████▌                                                                                                                  | 63/746 [14:10<2:38:14, 13.90s/it]
  9%|██████████▋                                                                                                                  | 64/746 [14:23<2:35:44, 13.70s/it]



 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 41/42 [00:05<00:00,  5.87it/s]

{'eval_loss': 0.6406190991401672, 'eval_runtime': 7.9295, 'eval_samples_per_second': 41.869, 'eval_steps_per_second': 5.297, 'epoch': 0.17}

  9%|██████████▉                                                                                                                  | 65/746 [14:45<3:05:05, 16.31s/it]

  9%|███████████                                                                                                                  | 66/746 [14:59<2:53:59, 15.35s/it]

  9%|███████████▏                                                                                                                 | 67/746 [15:14<2:55:19, 15.49s/it]

  9%|███████████▍                                                                                                                 | 68/746 [15:28<2:49:09, 14.97s/it]


 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 41/42 [00:05<00:00,  5.25it/s]

{'eval_loss': 0.5942732095718384, 'eval_runtime': 7.9584, 'eval_samples_per_second': 41.717, 'eval_steps_per_second': 5.277, 'epoch': 0.18}

  9%|███████████▌                                                                                                                 | 69/746 [15:51<3:14:55, 17.28s/it]

  9%|███████████▋                                                                                                                 | 70/746 [16:04<3:01:14, 16.09s/it]

 10%|███████████▉                                                                                                                 | 71/746 [16:18<2:53:04, 15.38s/it]
 10%|████████████                                                                                                                 | 72/746 [16:31<2:45:52, 14.77s/it]


 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                  | 36/42 [00:04<00:00,  7.13it/s]

{'eval_loss': 0.23433969914913177, 'eval_runtime': 7.8898, 'eval_samples_per_second': 42.079, 'eval_steps_per_second': 5.323, 'epoch': 0.19}

 10%|████████████▏                                                                                                                | 73/746 [16:56<3:20:24, 17.87s/it]

 10%|████████████▍                                                                                                                | 74/746 [17:10<3:06:50, 16.68s/it]

 10%|████████████▌                                                                                                                | 75/746 [17:23<2:54:43, 15.62s/it]

 10%|████████████▋                                                                                                                | 76/746 [17:41<3:00:05, 16.13s/it]



 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 41/42 [00:07<00:00,  1.87it/s]


 10%|████████████▉                                                                                                                | 77/746 [18:11<3:48:15, 20.47s/it]
{'loss': 0.2305, 'grad_norm': 17.0807433507548, 'learning_rate': 9.253112033195022e-06, 'epoch': 0.21}

