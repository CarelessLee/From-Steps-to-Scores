  0%|                                                                                                                                          | 0/47 [00:00<?, ?it/s]/export/project/jzhanggr/miniconda3/envs/lmflow/lib/python3.9/site-packages/torch/utils/checkpoint.py:464: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/export/project/jzhanggr/miniconda3/envs/lmflow/lib/python3.9/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/export/project/jzhanggr/miniconda3/envs/lmflow/lib/python3.9/site-packages/deepspeed/runtime/zero/stage_1_and_2.py:1830: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  overflow_gpu = get_accelerator().ByteTensor([overflow])
  2%|██▊                                                                                                                               | 1/47 [00:32<25:14, 32.92s/it]

  4%|█████▌                                                                                                                            | 2/47 [00:46<16:19, 21.76s/it]

  6%|████████▎                                                                                                                         | 3/47 [01:04<14:40, 20.00s/it]
{'loss': 44.625, 'grad_norm': 8774.911611912396, 'learning_rate': 9.777777777777779e-06, 'epoch': 0.06}

  9%|███████████                                                                                                                       | 4/47 [01:20<13:03, 18.22s/it]



 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                     | 5/6 [00:06<00:01,  1.69s/it]


 11%|█████████████▊                                                                                                                    | 5/47 [01:48<15:22, 21.97s/it]

 13%|████████████████▌                                                                                                                 | 6/47 [02:06<14:05, 20.62s/it]
{'loss': 4.3281, 'grad_norm': 1151.3803673572402, 'learning_rate': 9.111111111111112e-06, 'epoch': 0.13}


 17%|██████████████████████▏                                                                                                           | 8/47 [02:39<12:00, 18.47s/it]
{'loss': 53.75, 'grad_norm': 4858.945941870071, 'learning_rate': 8.666666666666668e-06, 'epoch': 0.17}





 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                     | 5/6 [00:07<00:01,  1.79s/it]

 19%|████████████████████████▉                                                                                                         | 9/47 [03:11<14:21, 22.68s/it]

 21%|███████████████████████████▍                                                                                                     | 10/47 [03:29<12:58, 21.05s/it]

 23%|██████████████████████████████▏                                                                                                  | 11/47 [03:51<12:48, 21.35s/it]

 26%|████████████████████████████████▉                                                                                                | 12/47 [04:06<11:27, 19.63s/it]
{'loss': 5.9531, 'grad_norm': 1518.8318035534257, 'learning_rate': 7.77777777777778e-06, 'epoch': 0.26}




 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                     | 5/6 [00:08<00:02,  2.10s/it]
{'eval_loss': 1.950301170349121, 'eval_runtime': 12.7609, 'eval_samples_per_second': 26.017, 'eval_steps_per_second': 0.47, 'epoch': 0.26}


 30%|██████████████████████████████████████▍                                                                                          | 14/47 [04:55<11:51, 21.57s/it]

 32%|█████████████████████████████████████████▏                                                                                       | 15/47 [05:12<10:40, 20.01s/it]

 34%|███████████████████████████████████████████▉                                                                                     | 16/47 [05:27<09:37, 18.63s/it]
{'loss': 2.1836, 'grad_norm': 874.7080339829716, 'learning_rate': 6.88888888888889e-06, 'epoch': 0.34}





 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                     | 5/6 [00:07<00:01,  1.83s/it]
{'eval_loss': 1.183076024055481, 'eval_runtime': 12.1608, 'eval_samples_per_second': 27.301, 'eval_steps_per_second': 0.493, 'epoch': 0.34}


 38%|█████████████████████████████████████████████████▍                                                                               | 18/47 [06:12<09:48, 20.30s/it]

 40%|████████████████████████████████████████████████████▏                                                                            | 19/47 [06:29<08:53, 19.04s/it]

 43%|██████████████████████████████████████████████████████▉                                                                          | 20/47 [06:43<07:56, 17.65s/it]
{'loss': 1.8203, 'grad_norm': 800.9487461355797, 'learning_rate': 6e-06, 'epoch': 0.43}




 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                     | 5/6 [00:07<00:01,  1.91s/it]

 45%|█████████████████████████████████████████████████████████▋                                                                       | 21/47 [07:15<09:33, 22.05s/it]

 47%|████████████████████████████████████████████████████████████▍                                                                    | 22/47 [07:31<08:21, 20.06s/it]

 49%|███████████████████████████████████████████████████████████████▏                                                                 | 23/47 [07:46<07:25, 18.58s/it]

 51%|█████████████████████████████████████████████████████████████████▊                                                               | 24/47 [08:01<06:47, 17.72s/it]
{'loss': 0.3223, 'grad_norm': 120.00551227982353, 'learning_rate': 5.1111111111111115e-06, 'epoch': 0.51}





 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                     | 5/6 [00:08<00:01,  1.91s/it]

 53%|████████████████████████████████████████████████████████████████████▌                                                            | 25/47 [08:29<07:36, 20.74s/it]

 55%|███████████████████████████████████████████████████████████████████████▎                                                         | 26/47 [08:43<06:33, 18.75s/it]

 57%|██████████████████████████████████████████████████████████████████████████                                                       | 27/47 [09:02<06:13, 18.70s/it]
{'loss': 0.3691, 'grad_norm': 76.53493798039396, 'learning_rate': 4.444444444444444e-06, 'epoch': 0.57}

 60%|████████████████████████████████████████████████████████████████████████████▊                                                    | 28/47 [09:17<05:31, 17.46s/it]




 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                     | 5/6 [00:07<00:01,  2.00s/it]

 62%|███████████████████████████████████████████████████████████████████████████████▌                                                 | 29/47 [09:46<06:18, 21.01s/it]

 64%|██████████████████████████████████████████████████████████████████████████████████▎                                              | 30/47 [10:03<05:39, 19.98s/it]
{'loss': 0.3271, 'grad_norm': 200.4539089322846, 'learning_rate': 3.777777777777778e-06, 'epoch': 0.64}

 66%|█████████████████████████████████████████████████████████████████████████████████████                                            | 31/47 [10:19<04:56, 18.56s/it]

 68%|███████████████████████████████████████████████████████████████████████████████████████▊                                         | 32/47 [10:35<04:27, 17.84s/it]




 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                     | 5/6 [00:08<00:01,  1.85s/it]

 70%|██████████████████████████████████████████████████████████████████████████████████████████▌                                      | 33/47 [11:02<04:50, 20.78s/it]
{'loss': 0.2617, 'grad_norm': 143.56080137392976, 'learning_rate': 3.1111111111111116e-06, 'epoch': 0.7}


 74%|████████████████████████████████████████████████████████████████████████████████████████████████                                 | 35/47 [11:35<03:41, 18.47s/it]

 77%|██████████████████████████████████████████████████████████████████████████████████████████████████▊                              | 36/47 [11:49<03:08, 17.15s/it]
{'loss': 0.2485, 'grad_norm': 94.47808362849315, 'learning_rate': 2.4444444444444447e-06, 'epoch': 0.77}




 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                     | 5/6 [00:07<00:02,  2.04s/it]

 79%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                           | 37/47 [12:20<03:33, 21.38s/it]

 81%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎                        | 38/47 [12:36<02:57, 19.74s/it]

 83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████                      | 39/47 [12:53<02:29, 18.73s/it]

 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                   | 40/47 [13:09<02:05, 17.94s/it]
{'loss': 0.1714, 'grad_norm': 11.330566285011507, 'learning_rate': 1.5555555555555558e-06, 'epoch': 0.85}





100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:10<00:00,  1.91s/it]

 87%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                | 41/47 [13:38<02:07, 21.22s/it]

 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎             | 42/47 [13:56<01:41, 20.24s/it]

 91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████           | 43/47 [14:10<01:14, 18.53s/it]

 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊        | 44/47 [14:24<00:51, 17.17s/it]
{'loss': 0.2466, 'grad_norm': 178.7109307654541, 'learning_rate': 6.666666666666667e-07, 'epoch': 0.94}




 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                     | 5/6 [00:07<00:02,  2.04s/it]

 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌     | 45/47 [14:54<00:42, 21.04s/it]
{'loss': 0.1826, 'grad_norm': 94.50543224367406, 'learning_rate': 4.444444444444445e-07, 'epoch': 0.96}


100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [15:30<00:00, 19.80s/it]
{'loss': 0.2075, 'grad_norm': 65.1426728240788, 'learning_rate': 0.0, 'epoch': 1.0}
{'train_runtime': 940.6542, 'train_samples_per_second': 3.171, 'train_steps_per_second': 0.05, 'train_loss': 11.55060463763298, 'epoch': 1.0}